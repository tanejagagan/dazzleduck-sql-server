# DazzleDuck Metrics Collector Configuration
# This file uses HOCON format (Human-Optimized Config Object Notation)
# All values can be overridden via environment variables or system properties

collector {
    # Whether the collector is enabled
    enabled = true

    # Target endpoints to scrape metrics from (Prometheus format)
    # Can be full URLs or relative paths (when target-prefix is set)
    targets = [
        "/actuator/prometheus"
    ]

    # Optional prefix for target URLs
    # When set, relative target paths will be resolved against this prefix
    # Example: target-prefix = "http://localhost:8080", target = "/actuator/prometheus"
    #          resolves to: "http://localhost:8080/actuator/prometheus"
    target-prefix = "http://localhost:8080"

    # Remote server URL to send collected metrics
    # Metrics are sent as Apache Arrow stream format
    server-url = "http://localhost:8081/ingest"

    # Path parameter appended to server URL query string
    path = "scraped_metrics"

    # Scrape interval in milliseconds
    # How often to collect metrics from target endpoints
    scrape-interval-ms = 15000

    # Tailing mode settings
    tailing {
        # Flush when buffer reaches this number of metrics
        flush-threshold = 100

        # Maximum time in milliseconds before flushing buffer
        # Even if threshold is not reached
        flush-interval-ms = 5000

        # Maximum metrics to buffer before dropping oldest
        max-buffer-size = 10000
    }

    # HTTP client settings
    http {
        # Connection timeout in milliseconds
        connection-timeout-ms = 5000

        # Read timeout in milliseconds
        read-timeout-ms = 10000

        # Maximum retry attempts for failed sends
        max-retries = 3

        # Initial retry delay in milliseconds (doubles each retry for exponential backoff)
        retry-delay-ms = 1000
    }

    # Collector identity settings
    identity {
        # Unique identifier for this collector instance
        id = "metrics-collector"

        # Human-readable name for this collector
        name = "Metrics Collector"

        # Host identifier (defaults to hostname if empty)
        host = ""
    }
}
